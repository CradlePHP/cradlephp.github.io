<!DOCTYPE html>
<html lang="en" class="branding ">
    <head>
        <meta charset="utf-8" />
        <title>CradlePHP</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

        <link rel="icon" type="image/png" href="/favicon.png" />
		<link rel="icon" type="image/gif" href="/favicon.gif" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link rel="stylesheet" type="text/css" href="/bower_components/font-awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" href="/bower_components/opensans-webfont-latin/css/opensans-latin.css" />
        <link rel="stylesheet" type="text/css" href="/bower_components/bootstrap/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="/www/styles/prism.css" />
        <link rel="stylesheet" type="text/css" href="/www/styles/custom.css" />

        <script type="text/javascript" src="/bower_components/jquery/dist/jquery.min.js"></script>
        <script type="text/javascript" src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    </head>

    <body>
    	<header>
            <nav class="navbar navbar-default navbar-branding navbar-static-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Cradle PHP" src="/www/images/logo-long.png" /></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="header">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/">Home</a></li>
                <li><a href="/docs/install.html">Getting Started</a></li>
                <li><a href="https://github.com/CradlePHP/Cradle"><i class="fa fa-github"></i></a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

        </header>

        <section class="body">
            <div class="container">
                
                 <div class="documentation">
    <div class="row">
        <div class="left col-xs-12 col-md-2">
            <h5>Getting Started</h5>
<ul>
    <li><a href="/docs/install.html">Vanilla Install</a></li>
    <li><a href="/docs/sink.html">Kitchen Sink Install</a></li>
</ul>

<h5>Features</h5>
<ul>
    <li><a href="/docs/events.html">Events</a></li>
    <li><a href="/docs/flows.html">Flows</a></li>
    <li><a href="/docs/routing.html">Routing</a></li>
    <li><a href="/docs/middleware.html">Middleware</a></li>
    <li><a href="/docs/request.html">Request</a></li>
    <li><a href="/docs/response.html">Response</a></li>
    <li><a href="/docs/piping.html">Piping</a></li>
    <li><a href="/docs/bootstrap.html">Bootstrap</a></li>
    <li><a href="/docs/integration.html">Integration</a></li>
    <li><a href="/docs/packages.html">Packages</a></li>
</ul>
   
        </div>
        <div class="right col-xs-12 col-md-10">
        	<h1>Routing</h1>
<ul>
<li><i class="fa fa-arrow-right"></i><a href="#basics">Basics</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#methods">Request Methods</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#paths">Request Paths</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#handlers">Route Handlers</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#mini">Mini Apps</a></li>
</ul>
<p><a name="basics"></a></p>
<h2><i class="fa fa-arrow-down"></i> Basics</h2>
<p>Routing is a subset of <a href="/docs/flows.html">Flows</a> which is a subset of
<a href="/docs/events.html">Events</a>. Routing wraps how event listeners work and
designed to resolve request methods and paths. The basic route listener
looks like the following.</p>
<h6>Basic Routing</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('Some Event', function($request, $response) {
    //Do something here
});

</code></pre>
<p>Which is very similar to how the basic event listener looks like in retrospec.
The two main differences here are instead of using <code class="language-php">-&gt;on()</code>, we are using
something called <code class="language-php">-&gt;get()</code> and there are two predefined arguments passed called a
<code class="language-php">$request</code> and a <code class="language-php">$response</code>. First let's take a look at what the <code class="language-php">-&gt;get()</code> is
exactly.</p>
<p><a name="methods"></a></p>
<h2><i class="fa fa-arrow-down"></i> Request Methods</h2>
<p>There are four common request methods a website deals with and they are the
following.</p>
<h3>Common Request Methods</h3>
<ul>
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
<p>When a page loads for example, that method is called <code class="language-php">GET</code> and when you submit
a form the method is usually a POST. So what we need to take into consideration
are a request method and from what URL path the user is requesting that from.
The following shows how we can consider requests which are called routing
methods.</p>
<h6>A routing method</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;route('GET', '/some/path/', function($request, $response) {
    //Do something here
});

</code></pre>
<p>This method has three arguments which combines thoughts of an event and
thoughts of a website request into one. The first argument is the request
method. You are free to put any arbitrary name here, but the user will send
up one of a fixed possibility which were discussed above. The second argument
in the <code class="language-php">-&gt;route()</code> method is called the request path. to simplify, this is
the folder request a user makes for example, if a user loaded
<a href="http://google.com/about"><a href="http://google.com/about">http://google.com/about</a></a>, <code class="language-php">/about</code> would be the
path name. The last argument just like events is called the route handler.</p>
<p>When it comes to request methods, mentioned before, the routing object has
predefined methods that acknowledge this commonality. The following all of
which wraps the <code class="language-php">-&gt;route()</code> method for your convenience.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()
    -&gt;get('/some/path/', function($request, $response) {})
    -&gt;post('/some/path/', function($request, $response) {})
    -&gt;put('/some/path/', function($request, $response) {})
    -&gt;delete('/some/path/', function($request, $response) {});

</code></pre>
<p>If you wanted listen to all request methods in one go you can do so like this.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;all('/some/path/', function($request, $response) {});

</code></pre>
<p><a href="paths"></a></p>
<h2><i class="fa fa-arrow-down"></i> Request Paths</h2>
<h3>Star Variables</h3>
<p>With paths, they can also be expressed with wildcards by adding a <code class="language-php">*</code> as in
the following.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('/some/*/stuff', function($request, $response) {});

</code></pre>
<p>When the request path is <code class="language-php">/some/good/stuff</code>, the above handler will be
called, like wise with <code class="language-php">/some/bad/stuff</code>, however <code class="language-php">/some/stuff</code> will not fire
the above handler.</p>
<p>To take on an <em>N</em> amount of wildcards you can add <code class="language-php">*</code> as in the following.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('/some/**/stuff', function($request, $response) {});

</code></pre>
<p>When the request path is <code class="language-php">/some/good/stuff</code>, the above handler will be
called, like wise with <code class="language-php">/some/even/better/stuff</code>, however <code class="language-php">/some/stuff</code> will
not fire the above handler. If you wanted a route handler to handle all
requests that deal with all /article requests for example, you can do so
like this.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;all('/article/**', function($request, $response) {});

</code></pre>
<p>Or like this.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;all('**', function($request, $response) {});

</code></pre>
<div class="alert alert-warning"><i class="fa fa-exclamation-triangle"></i> This will call the handler on every request. You may not want that.
</div>
<h3>Binding Parameters</h3>
<p>You can also use binding in routing if you care about the name of the
dynamic paths being passed. The following shows how this can be done.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('/some/:name/stuff', function($request, $response) {
    echo $request-&gt;getStage('name');
});

</code></pre>
<p><a href="handlers"></a></p>
<h2><i class="fa fa-arrow-down"></i> Route Handlers</h2>
<p>Much like events, routing can be expressed as a function or an include
like the following.</p>
<h6>Include Handlers</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('/some/path', include('/some/event/handler'));

</code></pre>
<p>Much like flows, routing can also call on class methods like the following.</p>
<h6>Class Handlers</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get('/some/path', 'Controller@action');

cradle()-&gt;get('/some/path', 'Controller::action');
</code></pre>
<p>Routing adopts the flow interface which allows this to happen.</p>
<h6>Handler Flows</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;get(
    '/some/path',
    'Another Event',
    include('/another/event.php'),
    'Controller@action',
    'Controller::action',
    ...$moreActions
);
</code></pre>
<p>Where it differs is, by default, routing provides two arguments which are
called a <code class="language-php">$request</code> and a <code class="language-php">$response</code>. For consistency a <code class="language-php">$request</code> and a
<code class="language-php">$response</code> should be passed whenever you trigger an event within a route
handler. For example, in flows, we discussed forking, and with routing the
exact same applies, with the addition of passing the $request and <code class="language-php">$response</code>
first like the example below.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
return function($request, $response) {
    //Do Something here

    //Trigger a fork
    if($good) {
        $this-&gt;triggerSubflow('A Good Event', $request, $response);
    } else {
        $this-&gt;triggerSubflow('A Bad Event', $request, $response);
    }
};

</code></pre>
<p><code class="language-php">$request</code> followed by <code class="language-php">$response</code> should always be at the start of your
arguments for consistency with other packages.</p>
<p><a href="mini"></a></p>
<h2><i class="fa fa-arrow-down"></i> Mini Apps</h2>
<p>If your routing with flows gets too large in one file, you can optionally
split up those routes in mini app files. In a new file, the following is
possible.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php

use Cradle\Framework\App;
use Cradle\Framework\Flow;

$app = App::i()
    -&gt;get('/search', 'Profile Search Page')
    -&gt;get('/detail/:id', 'Profile Detail Page');

return cradle()-&gt;app('/profile', $app);

</code></pre>
<p>Mini apps, in the above example match <code class="language-php">/profile/search</code> to
<code class="language-php">'Profile Search Page'</code>. Mini apps are just like the global <code class="language-php">cradle()</code> but t
here are a few things that need to be understood about them.</p>
<ol>
<li>Mini Apps have their own routing tables.</li>
<li>Events are still global</li>
<li>Pre Processors are triggered globally (not with the mini app middleware)</li>
<li>Errors are triggered globally (not with the mini app middleware)</li>
<li>Post Processors are triggered globally (not with the mini app middleware)</li>
</ol>
        </div>

    </div>
</div>

            </div>
        </section>
        <footer>
            <div class="container">
	<div class="top clearfix">
        <div class="left pull-left">
            <div>
                <div class="logo pull-left"><img src="/www/images/logo-square.png" /></div>
                <div class="title">Cradle PHP</div>
                <ul>
                    <li><a href="https://github.com/CradlePHP/Cradle">GitHub</a></li>
                    <li><a href="https://packagist.org/packages/cradlephp/cradle">Packagist</a></li>
                </ul>
            </div>
        </div>

        <div class="middle pull-right">
            <ul>
                <li><a href="https://cradlepphp.github.io/docs/intro.html">Getting Started</a></li>
                <li><a href="https://cradlepphp.github.io/docs/install.html">Install</a></li>
                <li><a href="https://cradlepphp.github.io/docs/intro.html">Documentation</a></li>
            </ul>
        </div>


    </div>
    <div class="masthead">
    	<center class="copy"><a href="https://travis-ci.org/CradlePHP/packages"><img src="https://travis-ci.org/CradlePHP/packages.svg?branch=master" alt="Travis CI" style="max-width:100%;"></a>
            <a href='https://coveralls.io/github/CradlePHP/packages?branch=master'><img src='https://coveralls.io/repos/github/CradlePHP/packages/badge.svg?branch=master' alt='Coverage Status' /></a>
            <a href="https://packagist.org/packages/cradlephp/packages"><img src="https://poser.pugx.org/cradlephp/packages/v/stable" alt="Latest Stable Version"  style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/packages"><img alt="Total Downloads" src="https://poser.pugx.org/cradlephp/packages/downloads" style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/packages"><img alt="Latest Unstable Version" src="https://poser.pugx.org/cradlephp/packages/v/unstable" style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/packages"><img alt="License" src="https://poser.pugx.org/cradlephp/packages/license" style="max-width:100%;"></a>
            <br /><br />&copy; CradlePHP 2016
        </center>
    </div>
</div>

        </footer>
        <script type="text/javascript" src="/www/scripts/prism.js"></script>
    </body>
</html>
