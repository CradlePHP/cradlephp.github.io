<!DOCTYPE html>
<html lang="en" class="branding ">
    <head>
        <meta charset="utf-8" />
        <title>Flows - CradlePHP</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        <meta name="description" content="Flows Handling Forking a Flow Importing a Flow API (7) Handling Flows is a subset of Events which means that you can also use Adva" />
        
        <meta name="keywords" content="php,framework,cradle,flows" />
        

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

        <link rel="icon" type="image/png" href="/favicon.png" />
		<link rel="icon" type="image/gif" href="/favicon.gif" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <!-- FACEBOOK TAGS -->
        <meta property="og:image" content="https://cradlephp.github.io/www/images/logo-long.png" />

        <meta property="og:title" content="Flows - CradlePHP" />

        <meta property="og:description" content="Flows Handling Forking a Flow Importing a Flow API (7) Handling Flows is a subset of Events which means that you can also use Adva" />

        <meta property="og:type" content="website" />

        <meta property="og:url" content="https://cradlephp.github.io/" />

        <!-- TWITTER TAGS -->
        <meta name="twitter:card" content="summary" />

        <meta name="twitter:image" content="https://cradlephp.github.io/www/images/logo-long.png" />

        <meta name="twitter:title" content="Flows - CradlePHP" />

        <meta name="twitter:description" content="Flows Handling Forking a Flow Importing a Flow API (7) Handling Flows is a subset of Events which means that you can also use Adva" />

        <meta name="twitter:url" content="https://cradlephp.github.io/" />

        <!-- SCHEMA.ORG TAGS -->
        <meta itemprop="name" content="Cradle PHP" />
        <meta itemprop="openingHours" content="Mo,Tu,We,Th,Fr 10:00-20:00" />

        <link itemprop="url" content="https://cradlephp.github.io/" />
        <link itemprop="logo" content="https://cradlephp.github.io/www/images/logo-long.png" />
        <link itemprop="image" content="https://cradlephp.github.io/www/images/logo-long.png" />

        <link rel="stylesheet" type="text/css" href="/bower_components/font-awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" href="/bower_components/opensans-webfont-latin/css/opensans-latin.css" />
        <link rel="stylesheet" type="text/css" href="/bower_components/bootstrap/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="/www/styles/prism.css" />
        <link rel="stylesheet" type="text/css" href="/www/styles/custom.css" />

        <script type="text/javascript" src="/bower_components/jquery/dist/jquery.min.js"></script>
        <script type="text/javascript" src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    </head>

    <body>
    	<header>
            <nav class="navbar navbar-default navbar-branding navbar-static-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img alt="Cradle PHP" src="/www/images/logo-long.png" /></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="header">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/">Home</a></li>
                <li><a href="/docs/install.html">Getting Started</a></li>
                <li><a href="https://github.com/CradlePHP/Cradle"><i class="fa fa-github"></i></a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

        </header>

        <section class="body">
            <div class="container">
                
                 <div class="documentation">
    <div class="row">
        <div class="left col-xs-12 col-md-2">
            <h5>Getting Started</h5>
<ul>
    <li><a href="/docs/install.html">Install</a></li>
    <li><a href="/docs/sink.html">Kitchen Sink</a></li>
</ul>

<h5>Concepts</h5>
<ul>
    <li><a href="/docs/events.html">Events</a></li>
    <li><a href="/docs/flows.html">Flows</a></li>
    <li><a href="/docs/routing.html">Routing</a></li>
    <li><a href="/docs/middleware.html">Middleware</a></li>
    <li><a href="/docs/request.html">Request</a></li>
    <li><a href="/docs/response.html">Response</a></li>
    <li><a href="/docs/integration.html">Integration</a></li>
    <li><a href="/docs/packages.html">Packages</a></li>
</ul>

<h5>Core Traits</h5>
<ul>
    <li><a href="/docs/helper.html">Helper</a></li>
    <li><a href="/docs/data.html">Data</a></li>
    <li><a href="/docs/resolver.html">Resolver</a></li>
    <li><a href="/docs/profiler.html">Profiler</a></li>
</ul>

<!--<h5>Core Packages</h5>
<ul>
    <li><a href="/docs/curl.html">cURL</a></li>
    <li><a href="/docs/handlebars.html">Handlebars</a></li>
    <li><a href="/docs/image.html">Image</a></li>
    <li><a href="/docs/sql.html">SQL</a></li>
</ul>

<h5>Kitchen Sink</h5>
<ul>
    <li><a href="/docs/sink-intro.html">Introduction</a></li>
    <li><a href="/docs/sink-models.html">Models</a></li>
    <li><a href="/docs/sink-jobs.html">Jobs</a></li>
    <li><a href="/docs/sink-controllers.html">Controllers</a></li>
    <li><a href="/docs/sink-templates.html">Templates</a></li>
    <li><a href="/docs/sink-templates.html">Custom CLI Commands</a></li>

    <li><a href="/docs/sink-files.html">File Uploading</a></li>
    <li><a href="/docs/sink-mail.html">Sending Mail</a></li>
    <li><a href="/docs/sink-queue.html">Queuing Jobs</a></li>
    <li><a href="/docs/sink-optimization.html">Optimization</a></li>
    <li><a href="/docs/sink-security.html">Security Cases</a></li>
    <li><a href="/docs/sink-i18n.html">i18n</a></li>
</ul>-->
   
        </div>
        <div class="right col-xs-12 col-md-10">
        	<h1>Flows</h1>
<ul>
<li><i class="fa fa-arrow-right"></i><a href="#handling">Handling</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#forking">Forking a Flow</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#importing">Importing a Flow</a></li>
<li><i class="fa fa-arrow-right"></i><a href="#api">API (7)</a></li>
</ul>
<p><a name="handling"></a></p>
<h2><i class="fa fa-arrow-down"></i> Handling</h2>
<p>Flows is a subset of <a href="/docs/events.html">Events</a> which means that you can also
use <a href="/docs/events.html#advanced">Advanced Listeners</a>, however the way event handlers
are done here are slightly different. Much like the
<a href="/docs/events.html#advanced">Event Basics</a>, you can include event handers
rather than defining in the same file <em>(though both ways work too)</em>.</p>
<h6>Include Handlers</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;flow('Some Event', include('/some/event/handler'));

</code></pre>
<p>Yes it does look like events, because it is events. Where it starts to change
is flows can handle class handlers and callable function strings like the
following.</p>
<h6>Class Handlers</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;flow('Some Event', 'Controller@action');

cradle()-&gt;flow('Some Event', 'Controller::action');

</code></pre>
<p>With the example above, we see that there is an event handler called
<code class="language-php">'Controller@action'</code>. This will instantiate the class called Controller and
then call a method called <code class="language-php">action()</code> given the above example. An example
Controller class looks like the following.</p>
<h6>A Controller</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
class Controller
{
    public function action($request, $response)
    {
        //Do Something here
    }
}

</code></pre>
<div class="alert alert-danger"><i class="fa fa-times"></i> Controllers that require constructor arguments will result in an error.
</div>
<div class="alert alert-info"><i class="fa fa-info-circle"></i> Though this example shows a Class Controller, Cradle doesn't require a specific
Controller nor a specific file structure.
</div>
<p>Another thing that flows can do is handle multiple event handlers in one go,
which is why this method is called a flow. An example on how to trigger
multiple event handlers using flows is shown below.</p>
<h6>Handler Flows</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;flow(
    'Some Event',
    'Another Event',
    include('/another/event.php'),
    'Controller@action',
    'Controller::action',
    ...$moreActions
);

</code></pre>
<p><a name="forking"></a></p>
<h2><i class="fa fa-arrow-down"></i> Forking a Flow</h2>
<p>Using triggers inside an event handler will allow a way to fork methods in flows as well. To set up a fork, the first thing to do is create a trigger inside an event handler like the example below.</p>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
return function() {
    //Do Something here

    //Trigger a fork
    if($good) {
        $this-&gt;subflow('A Good Event');
    } else {
        $this-&gt;subflow('A Bad Event');
    }
};
</code></pre>
<p>The above example shows two subflows being triggered called <code class="language-php">'A Good Event'</code>
and <code class="language-php">'A Bad Event'</code>. With these subflows we can now apply a fork. The
following shows how this can be done.</p>
<h6>Applying a Fork</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php
cradle()-&gt;flow(
    'Some Event',
    'Another Event',
    include('/another/event.php'),
    array(
        'A Good Event',
        'Controller@action',
    ),
    array(
        'A Bad Event',
        'Controller::action',
    ),
    ...$moreActions
);

</code></pre>
<p>The way we describe forked events in flows are with arrays. In this example
above, when a <code class="language-php">'A Good Event'</code> happens, <code class="language-php">'Controller@action'</code> will be fired
off. Oppositely, when a <code class="language-php">'A Bad Event'</code> happens, <code class="language-php">'Controller::action'</code> will be
fired off.</p>
<div class="alert alert-info"><i class="fa fa-info-circle"></i> A fork doesn't actually run in parallel. PHP is still linear.
</div>
<p><a name="importing"></a></p>
<h2><i class="fa fa-arrow-down"></i> Importing a Flow</h2>
<p>Using the import tool, we can optionally store flows in another file, that way,
we can use the same flows for different projects. To import a flow, we can use
the following method below.</p>
<h6>Importing a Flow</h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php

cradle()-&gt;import(include('/path/to/flow.php'));

</code></pre>
<p>An import file is simply a file that returns an array. An example on how it
looks like is shown by the following.</p>
<h6><code class="language-php">'/path/to/flow.php'</code></h6>
<pre class="code line-numbers language-php"><code class="marked">&lt;?php

return array(
    array(
        'Form Submit',
        'Some Form Event',
        'Another Form Event',
        array(
            'A Good Form Event',
            'Controller@action',
        ),
        array(
            'A Bad Form Event',
            'Controller::action',
        )
    ),
    array(
        'Render Page',
        'Some Page Event',
        'Another Page Event',
    )
);

</code></pre>
<p><a name="api"></a></p>
<h2><i class="fa fa-arrow-down"></i> API</h2>
<p><code class="language-php">flow</code> - Sets up a process flow</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;flow(
    'Some Event',
    'Another Event',
    include('/another/event.php'),
    'Controller@action',
    'Controller::action',
    ...$moreActions
)

</code></pre>
<hr />
<p><code class="language-php">protocol</code> - Adds a protocol used to custom parse an event name</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;protocol('debug', funtion($event, ...$args) {
    //Parse Event
});

//...

cradle()-&gt;trigger('debug://Hello World', $foo, $bar, 123);

</code></pre>
<hr />
<p><code class="language-php">subflow</code> - Calls a subflow to be called when there is an array fork</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;flow(
    'Flow Name',
    'Some@method',
    'Some::method',
    'Some://Event',
    'Some Event',
    function() {
        $this-&gt;subflow('A Good Fork');
    },
    [
        'A Good Fork',
        //...
    ]
);

</code></pre>
<hr />
<p><code class="language-php">trigger</code> - Calls an event considering classes and protocols</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;trigger('Some Event', ...$args);
cradle()-&gt;trigger('Some@method', ...$args);
cradle()-&gt;trigger('Some::method', ...$args);
cradle()-&gt;trigger('Some://Event', ...$args);

</code></pre>
<hr />
<p><code class="language-php">triggerController</code> - Explicitly calls a controller method</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;triggerController('Some@method', ...$args);

</code></pre>
<hr />
<p><code class="language-php">triggerFlow</code> - Triggers an array of events without naming the flow</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;triggerFlow(...$args);

cradle()-&gt;triggerFlow(
    'Some Event',
    'Some@method',
    'Some::method',
    'Some://Event'
);

cradle()-&gt;triggerFlow(
    'Some Event',
    function() {
        $this-&gt;subflow('A Good Fork');
    },
    [
        'A Good Fork',
        //...
    ]
);

</code></pre>
<hr />
<p><code class="language-php">triggerProtocol</code> - Explicitly triggers a protocol</p>
<pre class="code line-numbers language-php"><code class="marked">
cradle()-&gt;triggerProtocol('Some://Event', ...$args);

</code></pre>
        </div>

    </div>
</div>

            </div>
        </section>
        <footer>
            <div class="container">
	<div class="top clearfix">
        <div class="left pull-left">
            <div>
                <div class="logo pull-left"><img src="/www/images/logo-square.png" /></div>
                <div class="title">Cradle PHP</div>
                <ul>
                    <li><a href="https://github.com/CradlePHP/Cradle">GitHub</a></li>
                    <li><a href="https://packagist.org/packages/cradlephp/cradle">Packagist</a></li>
                </ul>
            </div>
        </div>

        <div class="middle pull-right">
            <ul>
                <li><a href="https://cradlepphp.github.io/docs/intro.html">Getting Started</a></li>
                <li><a href="https://cradlepphp.github.io/docs/install.html">Install</a></li>
                <li><a href="https://cradlepphp.github.io/docs/intro.html">Documentation</a></li>
            </ul>
        </div>


    </div>
    <div class="masthead">
    	<center class="copy">
            <a href="https://travis-ci.org/CradlePHP/framework"><img src="https://travis-ci.org/CradlePHP/framework.svg?branch=master" alt="Travis CI" style="max-width:100%;"></a>
            <a href='https://coveralls.io/github/CradlePHP/framework?branch=master'><img src='https://coveralls.io/repos/github/CradlePHP/framework/badge.svg?branch=master' alt='Coverage Status' /></a>
            <a href="https://packagist.org/packages/cradlephp/framework"><img src="https://poser.pugx.org/cradlephp/framework/v/stable" alt="Latest Stable Version"  style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/framework"><img alt="Total Downloads" src="https://poser.pugx.org/cradlephp/framework/downloads" style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/framework"><img alt="Latest Unstable Version" src="https://poser.pugx.org/cradlephp/framework/v/unstable" style="max-width:100%;"></a>
            <a href="https://packagist.org/packages/cradlephp/framework"><img alt="License" src="https://poser.pugx.org/cradlephp/framework/license" style="max-width:100%;"></a>
            <br /><br />&copy; CradlePHP 2016
        </center>
    </div>
</div>

        </footer>
        <script type="text/javascript" src="/www/scripts/prism.js"></script>
    </body>
</html>
